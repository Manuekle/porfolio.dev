---
import LanguageSelector from './LanguageSelector.astro'

interface Props {
  nav?: {
    home: string
    services: string
  }
}

const { nav } = Astro.props
---

<header class="bg-surface sticky top-0 z-50 border-b border-gray-200" data-aos="fade-down">
  <div class="mx-auto max-w-5xl px-6 py-4">
    <div class="flex items-center justify-between">
      <!-- Nav + Name -->
      <div class="flex items-center gap-4 md:gap-6">
        <a href="/" class="text-sm md:text-xs font-medium text-black transition-colors hover:text-gray-600">
          Manuel Erazo
        </a>
        
        <!-- Desktop Nav -->
        <nav class="hidden md:flex items-center gap-4">
          <a href="/" class="text-xs text-gray-600 transition-colors hover:text-black">{nav?.home || 'Inicio'}</a>
          <a href="/servicios" class="text-xs text-gray-600 transition-colors hover:text-black">{nav?.services || 'Servicios'}</a>
        </nav>
      </div>

      <!-- Desktop: Language + Mobile Menu Button -->
      <div class="flex items-center gap-3">
        <!-- Language Selector - always visible -->
        <LanguageSelector />

        <!-- Mobile Menu Button -->
        <button
          id="mobile-menu-btn"
          class="md:hidden flex items-center justify-center p-2 text-gray-600"
          aria-label="Toggle menu"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 menu-icon">
            <line x1="4" x2="20" y1="12" y2="12"/>
            <line x1="4" x2="20" y1="6" y2="6"/>
            <line x1="4" x2="20" y1="18" y2="18"/>
          </svg>
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 close-icon hidden">
            <line x1="18" x2="6" y1="6" y2="18"/>
            <line x1="6" x2="18" y1="6" y2="18"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden py-4 border-t border-gray-100 mt-4 overflow-hidden transition-all duration-300 max-h-0" style="max-height: 0;">
      <nav class="flex flex-col gap-4">
        <a href="/" class="text-sm text-gray-600 transition-colors hover:text-black">{nav?.home || 'Inicio'}</a>
        <a href="/servicios" class="text-sm text-gray-600 transition-colors hover:text-black">{nav?.services || 'Servicios'}</a>
        <a href="mailto:meerazo7@hotmail.com" class="text-sm text-gray-600 transition-colors hover:text-black">meerazo7@hotmail.com</a>
      </nav>
    </div>
  </div>
</header>

<script>
  const menuBtn = document.getElementById('mobile-menu-btn')
  const mobileMenu = document.getElementById('mobile-menu')
  const menuIcon = menuBtn?.querySelector('.menu-icon')
  const closeIcon = menuBtn?.querySelector('.close-icon')

  menuBtn?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden')
    if (!mobileMenu?.classList.contains('hidden')) {
      mobileMenu.style.maxHeight = '300px'
    } else {
      mobileMenu.style.maxHeight = '0'
    }
    menuIcon?.classList.toggle('hidden')
    closeIcon?.classList.toggle('hidden')
  })

  mobileMenu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      mobileMenu.classList.add('hidden')
      mobileMenu.style.maxHeight = '0'
      menuIcon?.classList.remove('hidden')
      closeIcon?.classList.add('hidden')
    })
  })
</script>
